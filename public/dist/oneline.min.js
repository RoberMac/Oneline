angular.module("Oneline",["ngTouch","ngAnimate","ngResource","ui.router","angular-jwt","angular-storage","Oneline.rootControllers","Oneline.settingsControllers","Oneline.timelineControllers","Oneline.timelineServices","Oneline.tokenHelperServices","Oneline.UIServices"]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider","jwtInterceptorProvider",function(e,t,r,n,i){e.html5Mode(!0),i.tokenGetter=function(){return localStorage.getItem("tokenList")},n.interceptors.push("jwtInterceptor"),r.otherwise("/"),t.state("settings",{url:"/?s",templateUrl:"/public/dist/settings.min.html",controller:"settingsCtrl"}).state("timeline",{url:"/{provider:all|twitter|instagram|weibo}",templateUrl:"/public/dist/timeline.min.html",controller:"timelineCtrl"})}]).factory("feedCache",["$cacheFactory",function(e){return e("feedCache")}]);
angular.module("Oneline.UIServices",[]).service("olUI",function(){});
angular.module("Oneline.timelineServices",[]).factory("Timeline",["$resource",function(e){return e("/timeline/:id")}]);
angular.module("Oneline.tokenHelperServices",[]).service("olTokenHelper",["jwtHelper","store",function(e,n){this.addToken=function(){var t=localStorage.getItem("addToken"),r=e.decodeToken(t).provider,i=n.get("tokenList")||[];i=o.removeToken(i,r),i.push(t),n.set("tokenList",i),n.remove("addToken")},this.removeToken=function(e){var t=n.get("tokenList")||[];t=o.removeToken(t,e),n.set("tokenList",t)},this.clearToken=function(){n.remove("tokenList")},this.getProviderList=function(){var o=n.get("tokenList")||[];return o.map(function(n){return e.decodeToken(n).provider})},this.isValidToken=function(){var o=n.get("tokenList")||[];return o.some(function(n){return!e.isTokenExpired(n)})};var o={removeToken:function(n,o){return n.filter(function(n){return o!==e.decodeToken(n).provider})}}}]);
angular.module("Oneline.rootControllers",[]).controller("rootController",["$scope","$timeout","store","olTokenHelper",function(e,i,r,o){e.providerList=o.getProviderList(),e.isTimeline=!1,e.timelineProvider=r.get("timelineProvider")||"all",r.set("timelineProvider",e.timelineProvider),e.updateProviderList=function(){i(function(){e.providerList=o.getProviderList()})},e.setTimeline=function(i){e.isTimeline=i},e.isAuth=function(i){return e.providerList.indexOf(i)>=0}}]);
angular.module("Oneline.settingsControllers",[]).controller("settingsCtrl",["$scope","$window","$state","$stateParams","store","olTokenHelper",function(e,t,n,o,i,r){r.isValidToken()&&"1"!==o.s?n.go("timeline",{provider:i.get("timelineProvider")}):null,e.setTimeline(!1),t.addEventListener("storage",function(t){"addToken"===t.key&&(r.addToken(),e.updateProviderList())}),e.toggleAuth=function(n){e.providerList.indexOf(n)<0?t.open("/auth/"+n+"/test","_blank"):(r.removeToken(n),e.updateProviderList())}}]);
angular.module("Oneline.timelineControllers",[]).controller("timelineCtrl",["$scope","$state","$stateParams","store","Timeline","olTokenHelper",function(e,i,t,n,o,l){function r(e){n.set("timelineProvider",e),i.go("timeline",{provider:e})}l.isValidToken()?null:i.go("settings",{settings:"settings"}),e.setTimeline(!0),e.providerList.indexOf(t.provider)>=0||"all"===t.provider?r(t.provider):i.go("timeline",{provider:n.get("timelineProvider")}),o.get({id:100},function(e){console.log(e)})}]);
//# sourceMappingURL=oneline.min.js.map